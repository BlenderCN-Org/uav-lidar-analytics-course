<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>GIS595/MEA792: UAV/lidar Data Analytics</title>

        <meta name="description" content="NCSU GIS595/MEA792: UAV/lidar Data Analytics course lecture">
        <meta name="author" content="NCSU OSGeoREL, Mitasova et al.">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/simple.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">
        <!-- For chalkboard plugin -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

        <!-- If the query includes 'print-pdf', include the PDF print sheet -->
        <script>
            if( window.location.search.match( /print-pdf/gi ) ) {
                var link = document.createElement( 'link' );
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = 'css/print/pdf.css';
                document.getElementsByTagName( 'head' )[0].appendChild( link );
            }
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->

        <style>
        * {
            /*font-family: Verdana, Geneva, sans-serif !important;*/
        }
        body {
        /*background-color: #FFF !important;*/
        /*
          background-image: url("pictures/elevation-nagshead.gif");
          background-repeat: no-repeat;
          background-position: left bottom;*/
        }
        .reveal section img {
            background: transparent;
            border: 0;
            box-shadow: 0 0 0 rgba(0, 0, 0, 0.15);
        }
        /* for standalone frame */
        /*
        iframe {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        */
        /* display: inline; background-color: #002B36; padding: 0px; margin: 0px */
        .rounded-corners {
            border: 0px solid black;
            border-radius: 5px;
            -moz-border-radius: 5px;
            -khtml-border-radius: 5px;
            -webkit-border-radius: 5px;
        }
        a {
            color: #060 !important;
        }
        a:hover {
            color: #060 !important;
            text-decoration: underline !important;
        }
        h1, h2, h3, h4, h5 {
            text-transform: none !important;
            /* word-break: keep-all; text-transform: none; font-size: 200%; line-height: 110%; */
            color: #060 !important;
            /* color: #444 !important; */ /* grey from the wab page */
            font-weight: bold !important;
            -webkit-hyphens: none !important;
            -moz-hyphens: none !important;
            -ms-hyphens: none !important;
            hyphens: none !important;
            line-height: 110% !important;
        }
        .reveal .progress span {
            background-color: #060 !important;
        }
        /* predefined element positioning */
        .top {
            /*position: relative;*/
            top: 5%;
            height: 45%; /* is the height even needed? */
        }
        .bottom {
            height: 45%;
        }
        .ne {
            position: absolute;
            top: 5%;
            right: 5%;
            height: 45%;
            width: 45%;
        }
        .nw {
            position: absolute;
            top: 5%;
            left: 5%;
            height: 45%;
            width: 45%;
        }
        .se {
            position: absolute;
            bottom: 5%;
            right: 5%;
            height: 45%;
            width: 45%;
        }
        .sw {
            position: absolute;
            bottom: 5%;
            left: 5%;
            height: 45%;
            width: 45%;
        }

        /* classes for sections with predefined elements */
        /* classes for sections with predefined elements */
        .right, .textimg > img, .textimg > video, .textimg > iframe, .imgtext > p, .imgtext > ul, .imgtext > ol, .imgtext > div {
            float: right;
            text-align: left;
            max-width: 47%;
        }
        .left, .imgtext > img, .imgtext > video, imgtext > iframe, .textimg > p, .textimg > ul, .textimg > ol, .textimg > div {
            float: left;
            text-align: left;
            max-width: 47%;
        }
        li > ul, li > ol {
            font-size: 85% !important;
            line-height: 110% !important;
        }
        .small {
            font-size: smaller !important;
            color: black;
            margin: 0.1em !important;
        }
        .credit {
            font-size: small !important;
            color: gray;
            margin: 0.1em !important;
        }
        .parent-page {
            display: inline-block;
            position: absolute;
            right: 30px;
            bottom: 30px;
            top: auto;
            left: auto;
            z-index: 30;
            font-size: medium !important;
        }
        </style>
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
<!-- This is a generated file. Do not edit. -->
<section>
    <h2>Open source UAS processing on cloud infrastructure</h2>
    <h4>GIS595-004/603; MEA592-006/601:</h4>
    <h4>UAS Mapping for 3D Modeling</h4>
    <h4 style="margin-top: 0.5em">
    Anna Petrasova, Vaclav Petras, Helena Mitasova</h4>
    <p class="title-foot">
        <a href="http://geospatial.ncsu.edu/" title="Center for Geospatial Analytics">Center for Geospatial Analytics,</a>
       <br> <a href="http://www.ncsu.edu/" title="North Carolina State University">North Carolina State University</a>
    </p>
</section>

<section>
<h3>Outline</h3>
<ul>
<li>Parallel computing concepts</li>
<li>Parallel computing infrastructure</li>
<li>Software licences and open source software</li>
<li>Overview of open source tools for UAS processing</li>
<li>OpenDroneMap</li>
</ul>
</section>

<section>
<h3>Parallel processing</h3>
<ul>
<li>Structure from Motion pipeline is typically more demanding
 than what we are used to usual with geospatial analysis</li>
<li class="fragment">solution is parallel processing (and more efficient algorithms in long term)</li>
<li class="fragment">types of parallel processing:
<ul>
    <li>CPU &mdash; tens of parallel processes</li>
    <li>GPU &mdash; hundreds and thousands of parallel processes</li>
    <li>cluster with nodes &mdash; each node has tens of CPUs/GPUs</li>
</ul>
</li></ul>
</section>

<section>
<h3>CPUs in geospatial context</h3>
<ul>
<li>Just because your computer has many CPUs, that doesn't mean
a computation uses them</li>
<li>Implementing parallel computing with CPUs can be done on the level of algorithm or user level</li>
</ul>
<br>
<img width="50%" src="img/open_source/CPUs.png">
</section>

<section>
<h3>CPUs in geospatial context: approaches</h3>
<ul>
<li><em>Embarassingly parallel problems</em> &mdash;  independent computations (e.g., solar radiation for more days)</li>
<li class="fragment" data-fragment-index="1"><em>Tiling approach</em> &mdash; divide spatial domain into tiles possibly with overlaps (e.g., interpolation)</li>
<li class="fragment" data-fragment-index="2"><em>Complex approaches</em> &mdash; depend on algorithms, often use tiling with communication between tiles (e.g., hydrology)</li>
</ul>
<iframe style="margin-bottom:30px" width="280" height="157" src="https://www.youtube.com/embed/eK6dWivro1g?rel=0&amp;controls=0&amp;showinfo=0;loop=1;playlist=eK6dWivro1g" frameborder="0" allow="encrypted-media" data-autoplay></iframe>
<img style="margin-left:30px;margin-right:30px" width="250px" src="img/open_source/tiling.jpg"  class="fragment" data-fragment-index="1">
<img width="300px" src="img/fusion_lidar_uav/fanimhhcolp.gif"  class="fragment" data-fragment-index="2">
</section>

<section>
<h3>CPUs in geospatial context: (dis)advantages</h3>
<p style="text-align: left"> Benefits:
<ul >
<li>Many problems fall into first two categories</li>
<li>It's fairly easy for users to parallelize their computations
using Python, or background processing</li>
</ul></p>
<p class="fragment" style="text-align: left"> Problems:
<ul class="fragment">
<li>Overhead can cause a program to run slower than on one CPU (running on <em>n</em> CPUs does not mean <em>n</em>-times speed-up)</li>
<li>We might not have enough memory for all processes</li>
</ul></p>
</section>

<section>
<h3>GPU computing</h3>
<ul>
<li>suitable for large number of very simple computational tasks with minimum memory requirement</li>
<li>hardware specific (e.g., CUDA platform is for Nvidia only)</li>
<li>complex programming APIs</li>
</ul>
</section>

<section>
<h3>SfM parallel computing</h3>
<ul>
<li>different parts of the pipeline are suitable for different parallelization types</li>
<li>e.g., PhotoScan can use GPU for image matching and depth maps creation</li>
</ul>
</section>

<section>
<h3>Parallel computing infrastructure (1)</h3>
<ul>
<li>laptop/desktop (low power, 8 CPUs) &mdash; for individuals</li>
<li class="fragment" data-fragment-index="1">server (medium power, tens of CPUs)
<ul>
<li>typically remote access, but physical machine is accessible</li>
<li> hardware owned by organizations, companies</li>
</ul>
</li>
</ul>
<img class="fragment" data-fragment-index="1" height="300px" src="img/open_source/server.png">
</section>

<section>
<h3>Parallel computing infrastructure (2)</h3>
<ul>
<li>cloud (medium power, tens of CPUs)
  <ul>
     <li>connected computers, actual hardware/OS hidden through virtualization</li>
     <li>easy to setup from user point of view</li>
     <li>computing is often not the primary application</li>
     <li>e.g., <a href="https://vcl.ncsu.edu/">NCSU VCL</a>, Amazon Web Services </li>
  </ul>
</ul>
<img class="stretch" src="img/open_source/vcl1.png">
</section>

<section>
<h3>Parallel computing infrastructure (3)</h3>
<ul>
<li>HPC, supercomputers (high power, thousands of CPUs) 
  <ul>
      <li>connected nodes, unix-based OS (e.g., Linux)</li>
      <li>not all programs can take advantage of it</li>
      <li>e.g., <a href="https://projects.ncsu.edu/hpc/main.php">NCSU HPC: henry2</a></li>
  </ul>
</li>
</ul>
<img class="stretch" src="img/open_source/supercomputer.jpg">
<p class="small"> Supercomputer Blue Waters, NCSA, Illinois</p>
</section>

<section>
<h3>Software licensing and cloud</h3>
<p style="text-align:left">When using any software, you need to deal with licenses. Proprietary software:
<ul>
<li>often has educational vs. commercial licenses</li>
<li>typically needs licences for each computer/user &mdash;
    may require special licenses for cloud (e.g., Agisoft floating licences), or per computer cores (e.g., Oracle) </li>
<li>price may be included in the cost of cloud virtual instances (e.g., Windows vs Linux)</li>
</ul>
</section>

<section>
<h3>Software licensing and cloud</h3>
<img class="stretch" src="img/open_source/vcl2.png">
<p> Source: <a href="https://vcl.ncsu.edu/2013/05/06/adobe-and-microsoft-office-licensed-products-to-be-removed-from-vcl/">NCSU VCL announcements</a>
</section>

<section>
<h3>Software licensing and cloud</h3>
<p style="text-align:left">Free and open source software:
<ul>
<li>is free to run, study, modify and distribute</li>
<li>users can use it for any purpose and don't have to worry about the license</li>
<li>most web and clouds are based on open source technologies</li>
</ul>
<img width="70%" src="img/open_source/top500.jpg">
</section>

<section>
<h3>Overview of open source tools for SfM</h3>
  <img src="img/open_source/opensource_overview.png" class="stretch">
  <p style="font-size: 65%">
    Based on and updated: Kirk McKelvey, <a href="https://2016.foss4g-na.org/sites/default/files/slides/sfm-foss4gna-2016_0.pdf">
    From UAV to Orthomosaic: Building a Toolchain</a>, FOSS4G NA 2016<br>
    See <a href="https://github.com/openMVG/awesome_3DReconstruction_list">curated list of papers and resources linked to open source 3D reconstruction from images</a>
</section>

<section>
  <h3>MicMac</h3>
  <ul><li>Developed by French National Geographic Institute (IGN)</li>
  <li>Set of command-line tools for the different parts of imagery processing</li>
  <li>Steep learning curve, see <a href="http://logiciels.ign.fr/IMG/pdf/docmicmac-2.pdf">PDF documentation</a></li>
  <li>Reconstruction results similar or better than other SfM software, see for example this
     <a href="http://www.int-arch-photogramm-remote-sens-spatial-inf-sci.net/XLI-B5/685/2016/isprs-archives-XLI-B5-685-2016.pdf">
     paper</a> or a <a href="https://www.youtube.com/watch?v=JCdGJ3yoEE0">video</a></li>
  <li>Not very active project, mostly one developer</li>
  <li><a href="https://opengeospatialdata.springeropen.com/articles/10.1186/s40965-017-0027-2">Recent overview paper about MicMac</a></li>
</section>

<section>
<img src="img/odm_logo.png" width="600px">
<p>
<p style="text-align:left">Full pipeline, some parts are using other projects:</p>
<ul><li>Structure from Motion (SfM) + dense cloud: <a href="https://github.com/mapillary/OpenSfM">OpenSfM</a>
     by <a href="https://www.mapillary.com/">Mapillary</a></li>
  <li>Mesh Generation</li>
  <li>Texturing / Blending: <a href="https://www.gcc.tu-darmstadt.de/home/proj/texrecon/">MVS-Texturing (part of MVE)</a></li>
  <li>Ortho photo creation</li>
  <li><a href="https://www.pdal.io/">PDAL</a> for DSM generation</li>
</ul>

</section>

<section>
  <h3>ODM vision: Open Data Ecosystem</h3>
<p style="text-align:left">The aim is for the toolchain to also be able to optionally push to a variety of online data repositories:
  <ul><li>high-resolution orthos to <a href="https://openaerialmap.org/">OpenAerialMap</a></li>
  <li>point clouds, DSMs to <a href="http://opentopography.org/">OpenTopography</a></li></ul>
</section>

<section>
<h3>ODM advantages</h3>
<ul><li>open source project, can be used commercially,</li>
 <li>active community: free real-time support on <a href="https://gitter.im/OpenDroneMap/OpenDroneMap">Gitter</a></li>
  <li>easy for batch processing,</li>
  <li>active development, new features coming, see
    <a href="https://github.com/OpenDroneMap/OpenDroneMap/wiki/Roadmap">roadmap</a></li>
</ul>
</section>

<section>
<h3>ODM drawbacks</h3>
<ul>
  <li>GCPs need to be used during reconstruction process to increase precision and avoid 'doming effect'</li>
  <li>missing GUI for GCPs identification</li>
  <li>missing GPU acceleration</li>
</ul>
</section>

<section>
  <h3>ODM results</h3>
  Improvements in mosaicing:<br>
  <img width="45%" src="img/ODM_ortho_old.jpg">
  <img width="45%" src="img/ODM_ortho_new.jpg">
</section>
<section>
  <h3>ODM results</h3>
  Difference between lidar and ODM reveals doming effect:<br>
  <img width="60%" src="img/ODM_diff_lidar.jpg">
</section>

<section>
    <h3>Assignment</h3>
    <p style="text-align:left"> We will run ODM on Ubuntu VCL:
        <ul>
          <li>Mid Pines sample dataset</li>
          <li>using Docker &mdash; through command line </li> 
          <li>using ODM web interface WebODM</li>
        </ul> 
</section>
<section>
    <h3>What is Docker?</h3>
<ul>
    <li>tool for easy deploying and running applications by using containers</li>
    <li class="fragment">containers allow to package an application with dependencies</li>
    <li class="fragment">no installation, keeps your system clean</li>
    <li class="fragment">ensures application runs no matter what customized settings your machine has</li>
    <li class="fragment">similar to Virtual Machine, but much more efficient, takes up less space</li>
    <li class="fragment">based on Linux, but there is also Docker for Windows</li>
</ul>
</section>

<section>
<h3>WebODM: ODM with web browser interface</h3>
<ul>
  <li>allows viewing results as a 2D webmap, 3D point cloud</li>
  <li>learn more at <a href="https://github.com/OpenDroneMap/WebODM">WebODM</a></li>
  <li>we will deploy WebODM using Docker</li>
  </ul>
  <img class="stretch" src="https://raw.githubusercontent.com/OpenDroneMap/WebODM/master/screenshots/ui-mockup.png">
</section>

<section>
    <h3>What we have learned</h3>
<ul>
    <li>what is parallel computing about</li>
    <li>what types of computing infrastructure are available</li>
    <li>software licensing and cloud</li>
    <li>current state of open source tools for SfM</li>
</ul>
</section>
        </div>  <!-- slides -->

    </div>  <!-- reveal -->

    <!--
        Home button or link to a parent page
        If you want this to be unique for every page (slide deck),
        then remove it from here and put it at the end of each
        file (or series of files) creating one page
        (the position will be little different)
        TODO: some JS is needed to move it to the right position
    -->
    <div class="parent-page">
        <!-- alternative symbol: &#x1f3e0; -->
        <a href=".." title="Course website">
            <img width="15px" src="img/home.svg"></a>
    </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                // Display controls in the bottom right corner
                controls: false,

                // Display a presentation progress bar
                progress: true,
                
                center: true,
                
                // Display the page number of the current slide
                slideNumber: false,

                // Enable the slide overview mode
                overview: true,

                // Turns fragments on and off globally
                fragments: true,

                // The "normal" size of the presentation, aspect ratio will be preserved
                // when the presentation is scaled to fit different resolutions. Can be
                // specified using percentage units.
                // width: 960,
                // height: 700,
                
                // Factor of the display size that should remain empty around the content
                margin: 0.05,  // increase?

                // Bounds for smallest/largest possible scale to apply to content
                minScale: 0.5,
                maxScale: 5.0,

                theme: Reveal.getQueryHash().theme,  // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

                // Push each slide change to the browser history
                history: true,
                // Enable keyboard shortcuts for navigation
                keyboard: true,

                // Vertical centering of slides
                center: true,

                // Enables touch navigation on devices with touch input
                touch: true,

                // Loop the presentation
                loop: false,
                // Flags if the presentation is running in an embedded mode,
                // i.e. contained within a limited portion of the screen
                embedded: false,

                // Number of milliseconds between automatically proceeding to the
                // next slide, disabled when set to 0, this value can be overwritten
                // by using a data-autoslide attribute on your slides
                autoSlide: 0,

                // Stop auto-sliding after user input
                autoSlideStoppable: true,

                // Enable slide navigation via mouse wheel
                mouseWheel: false,

                // Hides the address bar on mobile devices
                hideAddressBar: true,

                // Opens links in an iframe preview overlay
                previewLinks: false,

                // Transition speed
                transitionSpeed: 'default', // default/fast/slow

                // Transition style for full page slide backgrounds
                backgroundTransition: 'none', // default/none/slide/concave/convex/zoom

                // Number of slides away from the current that are visible
                viewDistance: 3,

                // Parallax background image
                //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

                // Parallax background size
                //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"
                chalkboard: {
                // optionally load pre-recorded chalkboard drawing from file
                    src: "chalkboard.json",
			    },
                math: {
                        mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
                        config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
                },
                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/math/math.js', async: true },
                    { src: 'plugin/chalkboard/chalkboard.js' }
                ],
                keyboard: {
                    67: function() { RevealChalkboard.toggleNotesCanvas() },	// toggle notes canvas when 'c' is pressed
                    66: function() { RevealChalkboard.toggleChalkboard() },	// toggle chalkboard when 'b' is pressed
                    46: function() { RevealChalkboard.clear() },	// clear chalkboard when 'DEL' is pressed
                    8: function() { RevealChalkboard.reset() },	// reset chalkboard data on current slide when 'BACKSPACE' is pressed
                    68: function() { RevealChalkboard.download() },	// downlad recorded chalkboard drawing when 'd' is pressed
                }
            });

        </script>
    </body>
</html>
